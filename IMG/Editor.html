<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>√âditeur Neon</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: monospace;
            display: flex;
            height: 100vh;
            background-color: #0f0f0f;
            color: #00ffcc;
        }

        #explorer {
            width: 220px;
            background-color: #111;
            padding: 10px;
            border-right: 2px solid #00ffcc;
        }

            #explorer h3 {
                margin-top: 0;
                color: #00ffff;
            }

            #explorer ul {
                list-style: none;
                padding: 0;
            }

            #explorer li {
                padding: 6px;
                cursor: pointer;
                border-bottom: 1px solid #222;
            }

                #explorer li:hover {
                    background-color: #222;
                }

        #editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        #controls {
            background-color: #111;
            padding: 10px;
            text-align: right;
            border-bottom: 2px solid #00ffcc;
        }

        button {
            padding: 6px 12px;
            background-color: #00ffcc;
            border: none;
            color: #111;
            font-weight: bold;
            cursor: pointer;
            margin-left: 10px;
        }

        #editor {
            flex: 1;
            display: flex;
            background-color: #0f0f0f;
            overflow: auto;
        }

        #lines {
            background-color: #111;
            padding: 10px;
            text-align: right;
            color: #555;
            user-select: none;
        }

        #code {
            flex: 1;
            padding: 10px;
            outline: none;
            white-space: pre-wrap;
            overflow-x: auto;
            color: #eee;
        }

        /* Coloration syntaxique */
        .tag {
            color: #ff00ff;
        }

        .attr {
            color: #00ffff;
        }

        .string {
            color: #ffff00;
        }
    </style>
</head>
<body>
    <div id="explorer">
        <h3>üìÅ Fichiers</h3>
        <ul>
            <li onclick="loadFile('index.html')">index.html</li>
            <li onclick="loadFile('style.css')">style.css</li>
            <li onclick="loadFile('script.js')">script.js</li>
        </ul>
    </div>

    <div id="editor-container">
        <div id="controls">
            <button onclick="runCode()">Ex√©cuter</button>
            <button onclick="openInNewTab()">Ouvrir dans un onglet</button>
        </div>
        <div id="editor">
            <div id="lines"></div>
            <div id="code" contenteditable="true" oninput="updateLines();highlight();">
                &lt;!DOCTYPE html&gt;
                &lt;html&gt;
                &lt;head&gt;
                &lt;title&gt;Neon Test&lt;/title&gt;
                &lt;/head&gt;
                &lt;body&gt;
                &lt;h1&gt;Hello Kenzo&lt;/h1&gt;
                &lt;/body&gt;
                &lt;/html&gt;
            </div>
        </div>
    </div>

    <script>
        function updateLines() {
            const code = document.getElementById("code").innerText;
            const lines = code.split("\n").length;
            const linesDiv = document.getElementById("lines");
            linesDiv.innerHTML = "";
            for (let i = 1; i <= lines; i++) {
                linesDiv.innerHTML += i + "<br>";
            }
        }

        function runCode() {
            const raw = document.getElementById("code").innerText;
            const html = raw.replace(/&lt;/g, "<").replace(/&gt;/g, ">");
            const previewWindow = window.open("", "preview");
            previewWindow.document.open();
            previewWindow.document.write(html);
            previewWindow.document.close();
        }

        function openInNewTab() {
            const raw = document.getElementById("code").innerText;
            const html = raw.replace(/&lt;/g, "<").replace(/&gt;/g, ">");
            const newWindow = window.open("", "_blank");
            newWindow.document.open();
            newWindow.document.write(html);
            newWindow.document.close();
        }

        function highlight() {
            const codeDiv = document.getElementById("code");
            let html = codeDiv.innerText;

            html = html.replace(/&lt;\/?[\w\s="'-]+&gt;/g, match => {
                return `<span class="tag">${match}</span>`;
            });

            html = html.replace(/[\w-]+(?==)/g, match => {
                return `<span class="attr">${match}</span>`;
            });

            html = html.replace(/"[^"]*"/g, match => {
                return `<span class="string">${match}</span>`;
            });

            codeDiv.innerHTML = html;
            placeCaretAtEnd(codeDiv);
        }

        function placeCaretAtEnd(el) {
            const range = document.createRange();
            const sel = window.getSelection();
            range.selectNodeContents(el);
            range.collapse(false);
            sel.removeAllRanges();
            sel.addRange(range);
        }

        function loadFile(name) {
            const templates = {
                "index.html": `&lt;!DOCTYPE html&gt;
&lt;html&gt;
          &lt;head&gt;
            &lt;title&gt;Page HTML&lt;/title&gt;
          &lt;/head&gt;
          &lt;body&gt;
            &lt;p&gt;Bienvenue Kenzo&lt;/p&gt;
          &lt;/body&gt;
&lt;/html&gt;`,
                "style.css": `body {
          background-color: black;
          color: neongreen;
}`,
                "script.js": `console.log("Hello Kenzo");`
            };
            document.getElementById("code").innerText = templates[name];
            updateLines();
            highlight();
        }

        updateLines();
        highlight();
    </script>
</body>
</html>
